<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Piedra, Papel o Tijera üî•</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  :root { --rojo: #ff2d55; --rosa: #ff6b95; --morado: #7c2d8c; --dorado: #ffd166; --negro: #0a0007; --gris: #1a0a14; }
  body { font-family: 'DM Sans', sans-serif; min-height: 100vh; background: var(--negro); display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; padding: 20px; overflow-x: hidden; }
  body::before { content: ''; position: fixed; inset: 0; background: radial-gradient(ellipse 80% 60% at 20% 10%, rgba(124,45,140,0.25) 0%, transparent 60%), radial-gradient(ellipse 60% 50% at 80% 90%, rgba(255,45,85,0.2) 0%, transparent 60%); pointer-events: none; z-index: 0; }
  .pantalla { display: none; flex-direction: column; align-items: center; justify-content: center; width: 100%; max-width: 520px; position: relative; z-index: 1; }
  .pantalla.activa { display: flex; }
  .logo { font-family: 'Playfair Display', serif; font-size: 2.6rem; font-weight: 900; background: linear-gradient(135deg, #fff 0%, var(--rosa) 50%, var(--dorado) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; line-height: 1.1; margin-bottom: 6px; }
  .logo-sub { color: rgba(255,255,255,0.4); font-size: 0.85rem; letter-spacing: 3px; text-transform: uppercase; margin-bottom: 40px; }
  .seccion-label { font-size: 0.68rem; letter-spacing: 4px; color: rgba(255,255,255,0.35); text-transform: uppercase; margin-bottom: 14px; align-self: flex-start; }
  .niveles { display: flex; flex-direction: column; gap: 10px; width: 100%; margin-bottom: 32px; }
  .card-nivel { display: flex; align-items: center; gap: 16px; padding: 16px 20px; border-radius: 16px; border: 1.5px solid rgba(255,255,255,0.07); background: rgba(255,255,255,0.03); cursor: pointer; transition: all 0.25s; position: relative; overflow: hidden; }
  .card-nivel::before { content: ''; position: absolute; inset: 0; opacity: 0; transition: opacity 0.25s; }
  .card-nivel.nivel-1::before { background: linear-gradient(120deg, rgba(255,107,149,0.12), transparent); }
  .card-nivel.nivel-2::before { background: linear-gradient(120deg, rgba(255,45,85,0.18), transparent); }
  .card-nivel.nivel-3::before { background: linear-gradient(120deg, rgba(255,77,0,0.22), transparent); }
  .card-nivel.nivel-4::before { background: linear-gradient(120deg, rgba(150,0,255,0.18), transparent); }
  .card-nivel:hover::before, .card-nivel.activo::before { opacity: 1; }
  .card-nivel.activo { border-color: var(--rojo); box-shadow: 0 0 20px rgba(255,45,85,0.2); }
  .nivel-icono { font-size: 1.8rem; flex-shrink: 0; }
  .nivel-texto h3 { font-size: 0.95rem; font-weight: 600; margin-bottom: 2px; }
  .nivel-texto p { font-size: 0.75rem; color: rgba(255,255,255,0.45); }
  .nivel-badge { margin-left: auto; font-size: 0.65rem; padding: 3px 10px; border-radius: 20px; font-weight: 600; letter-spacing: 1px; flex-shrink: 0; }
  .badge-1 { background: rgba(255,107,149,0.2); color: var(--rosa); border: 1px solid rgba(255,107,149,0.3); }
  .badge-2 { background: rgba(255,45,85,0.2); color: #ff6060; border: 1px solid rgba(255,45,85,0.3); }
  .badge-3 { background: rgba(255,77,0,0.2); color: var(--dorado); border: 1px solid rgba(255,77,0,0.3); }
  .badge-4 { background: rgba(150,0,255,0.2); color: #d580ff; border: 1px solid rgba(150,0,255,0.3); }
  .rondas-grid { display: flex; gap: 10px; width: 100%; margin-bottom: 35px; }
  .btn-ronda { flex: 1; padding: 14px 8px; background: rgba(255,255,255,0.04); border: 1.5px solid rgba(255,255,255,0.08); border-radius: 14px; color: rgba(255,255,255,0.6); font-size: 0.82rem; font-weight: 500; cursor: pointer; transition: all 0.2s; font-family: 'DM Sans', sans-serif; line-height: 1.3; }
  .btn-ronda:hover, .btn-ronda.sel { border-color: var(--rojo); color: white; background: rgba(255,45,85,0.12); }
  .btn-libre { border-color: rgba(255,209,102,0.3) !important; color: var(--dorado) !important; }
  .btn-libre.sel { border-color: var(--dorado) !important; background: rgba(255,209,102,0.12) !important; }
  .btn-jugar { width: 100%; padding: 18px; font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 700; background: linear-gradient(135deg, var(--rojo), var(--morado)); border: none; border-radius: 50px; color: white; cursor: pointer; letter-spacing: 2px; transition: all 0.25s; box-shadow: 0 6px 30px rgba(255,45,85,0.35); }
  .btn-jugar:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(255,45,85,0.5); }
  .nombres-grid { display: flex; gap: 10px; width: 100%; margin-bottom: 28px; }
  .input-nombre { flex: 1; padding: 13px 16px; background: rgba(255,255,255,0.05); border: 1.5px solid rgba(255,255,255,0.1); border-radius: 14px; color: white; font-size: 0.9rem; font-family: 'DM Sans', sans-serif; outline: none; transition: all 0.2s; text-align: center; }
  .input-nombre::placeholder { color: rgba(255,255,255,0.25); }
  .input-nombre:focus { border-color: var(--rojo); background: rgba(255,45,85,0.07); }
  .header-juego { display: flex; align-items: center; justify-content: space-between; width: 100%; margin-bottom: 18px; }
  .btn-volver { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.12); color: rgba(255,255,255,0.7); padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.82rem; font-family: 'DM Sans', sans-serif; transition: all 0.2s; }
  .btn-volver:hover { background: rgba(255,255,255,0.12); color: white; }
  .info-ronda { font-size: 0.82rem; color: rgba(255,255,255,0.4); }
  .info-ronda span { color: white; font-weight: 600; }
  .nivel-indicator { display: inline-flex; align-items: center; gap: 6px; font-size: 0.72rem; padding: 4px 12px; border-radius: 20px; font-weight: 600; letter-spacing: 1px; margin-bottom: 16px; border: 1px solid; }
  .ni-1 { background: rgba(255,107,149,0.12); color: var(--rosa); border-color: rgba(255,107,149,0.25); }
  .ni-2 { background: rgba(255,45,85,0.15); color: #ff7070; border-color: rgba(255,45,85,0.3); }
  .ni-3 { background: rgba(255,77,0,0.15); color: var(--dorado); border-color: rgba(255,77,0,0.3); }
  .ni-4 { background: rgba(150,0,255,0.12); color: #d580ff; border-color: rgba(150,0,255,0.25); }
  .progreso-container { width: 100%; margin-bottom: 22px; }
  .progreso-nombres { display: flex; justify-content: space-between; font-size: 0.78rem; margin-bottom: 7px; }
  .pn1 { color: #6ee7b7; } .pn2 { color: var(--rosa); }
  .barras { display: flex; height: 6px; border-radius: 10px; overflow: hidden; gap: 3px; }
  .barra-punto { flex: 1; border-radius: 4px; background: rgba(255,255,255,0.08); transition: background 0.4s; }
  .barra-punto.j1 { background: #6ee7b7; } .barra-punto.j2 { background: var(--rojo); }
  .arena { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 16px; }
  .jugador-box { display: flex; flex-direction: column; align-items: center; gap: 8px; }
  .nombre-jugador { font-size: 0.72rem; color: rgba(255,255,255,0.4); letter-spacing: 2px; text-transform: uppercase; }
  .display-emoji { font-size: 3rem; width: 105px; height: 105px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.04); border-radius: 24px; border: 1.5px solid rgba(255,255,255,0.08); transition: all 0.3s; position: relative; }
  .display-emoji.ganaste { border-color: #6ee7b7; box-shadow: 0 0 25px rgba(110,231,183,0.4); animation: pulso 0.5s ease; }
  .display-emoji.perdiste { border-color: var(--rojo); box-shadow: 0 0 25px rgba(255,45,85,0.4); animation: temblor 0.4s ease; }
  .display-emoji.empate { border-color: var(--dorado); box-shadow: 0 0 20px rgba(255,209,102,0.3); }
  .display-emoji.esperando { opacity: 0.35; }
  .display-emoji.listo { border-color: #6ee7b7; box-shadow: 0 0 12px rgba(110,231,183,0.3); opacity: 1; }
  .check-listo { position: absolute; top: -8px; right: -8px; background: #6ee7b7; color: #000; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: bold; opacity: 0; transition: opacity 0.3s; }
  .check-listo.visible { opacity: 1; }
  .vs { font-size: 1.1rem; font-weight: 700; color: rgba(255,255,255,0.2); letter-spacing: 2px; }
  .resultado { font-size: 1.1rem; min-height: 40px; text-align: center; margin-bottom: 16px; }
  .botones { display: flex; gap: 12px; margin-bottom: 18px; flex-wrap: wrap; justify-content: center; }
  button.btn-opcion { font-size: 2rem; width: 80px; height: 80px; border: 1.5px solid rgba(255,255,255,0.08); border-radius: 20px; background: rgba(255,255,255,0.04); cursor: pointer; transition: all 0.2s ease; color: white; font-family: inherit; }
  button.btn-opcion:hover { transform: translateY(-5px) scale(1.08); background: rgba(255,45,85,0.2); border-color: var(--rojo); box-shadow: 0 8px 25px rgba(255,45,85,0.3); }
  button.btn-opcion:active { transform: scale(0.92); }
  .teclado-info { display: flex; justify-content: space-between; width: 100%; margin-bottom: 12px; font-size: 0.75rem; color: rgba(255,255,255,0.35); }
  .teclado-info .keys { display: flex; gap: 5px; align-items: center; }
  .key { background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.15); border-radius: 5px; padding: 2px 7px; font-size: 0.72rem; color: rgba(255,255,255,0.5); }
  .mensaje-local { font-size: 0.88rem; color: rgba(255,255,255,0.4); margin-bottom: 10px; text-align: center; min-height: 22px; }
  .marcador { display: flex; gap: 12px; }
  .stat { text-align: center; background: rgba(255,255,255,0.04); border-radius: 14px; padding: 10px 18px; border: 1px solid rgba(255,255,255,0.07); }
  .stat .numero { font-size: 1.6rem; font-weight: 700; }
  .stat .label { font-size: 0.68rem; color: rgba(255,255,255,0.35); margin-top: 2px; }
  .victorias .numero { color: #6ee7b7; } .derrotas .numero { color: var(--rojo); } .empates .numero { color: var(--dorado); }
  .overlay-dare { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 100; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(4px); }
  .overlay-dare.visible { display: flex; }
  .dare-card { max-width: 400px; width: 100%; background: var(--gris); border-radius: 28px; padding: 36px 30px; text-align: center; border: 1px solid rgba(255,255,255,0.1); position: relative; animation: aparecer 0.4s cubic-bezier(.17,.67,.35,1.3); box-shadow: 0 20px 80px rgba(255,45,85,0.3); }
  .dare-card::before { content: ''; position: absolute; inset: 0; border-radius: 28px; background: linear-gradient(135deg, rgba(255,45,85,0.06), rgba(124,45,140,0.06)); pointer-events: none; }
  .dare-nivel-badge { display: inline-flex; align-items: center; gap: 5px; font-size: 0.65rem; padding: 4px 14px; border-radius: 20px; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 18px; border: 1px solid; }
  .dnb-1 { background: rgba(255,107,149,0.1); color: var(--rosa); border-color: rgba(255,107,149,0.2); }
  .dnb-2 { background: rgba(255,45,85,0.15); color: #ff7070; border-color: rgba(255,45,85,0.25); }
  .dnb-3 { background: rgba(255,77,0,0.12); color: var(--dorado); border-color: rgba(255,77,0,0.25); }
  .dnb-4 { background: rgba(150,0,255,0.12); color: #d580ff; border-color: rgba(150,0,255,0.2); }
  .dare-perdedor { font-size: 0.8rem; color: rgba(255,255,255,0.35); margin-bottom: 10px; letter-spacing: 1px; }
  .dare-perdedor span { color: var(--rosa); font-weight: 600; }
  .dare-titulo { font-family: 'Playfair Display', serif; font-size: 1.5rem; font-weight: 700; margin-bottom: 16px; line-height: 1.3; color: white; }
  .dare-emoji-grande { font-size: 3rem; margin-bottom: 16px; display: block; }
  .dare-descripcion { font-size: 0.95rem; color: rgba(255,255,255,0.7); line-height: 1.6; margin-bottom: 28px; }
  .btn-cumplido { width: 100%; padding: 15px; font-family: 'Playfair Display', serif; font-size: 1rem; font-weight: 700; background: linear-gradient(135deg, var(--rojo), var(--morado)); border: none; border-radius: 50px; color: white; cursor: pointer; transition: all 0.2s; box-shadow: 0 6px 25px rgba(255,45,85,0.35); letter-spacing: 1px; }
  .btn-cumplido:hover { transform: scale(1.03); }
  .dare-skip { margin-top: 12px; font-size: 0.78rem; color: rgba(255,255,255,0.25); cursor: pointer; transition: color 0.2s; }
  .dare-skip:hover { color: rgba(255,255,255,0.5); }
  .trofeo { font-size: 5rem; margin-bottom: 15px; animation: aparecer 0.5s ease; }
  .ganador-titulo { font-family: 'Playfair Display', serif; font-size: 2rem; font-weight: 700; margin-bottom: 6px; text-align: center; }
  .ganador-sub { color: rgba(255,255,255,0.35); margin-bottom: 35px; font-size: 0.9rem; }
  .stats-finales { display: flex; gap: 15px; margin-bottom: 35px; }
  .stat-final { text-align: center; background: rgba(255,255,255,0.04); border-radius: 16px; padding: 14px 22px; border: 1px solid rgba(255,255,255,0.08); }
  .stat-final .n { font-size: 2rem; font-weight: 700; }
  .stat-final .l { font-size: 0.72rem; color: rgba(255,255,255,0.35); margin-top: 3px; }
  .btns-final { display: flex; gap: 12px; }
  .btn-revancha { padding: 14px 30px; font-family: 'Playfair Display', serif; font-size: 1rem; font-weight: 700; background: linear-gradient(135deg, var(--rojo), var(--morado)); border: none; border-radius: 50px; color: white; cursor: pointer; transition: all 0.2s; }
  .btn-revancha:hover { transform: scale(1.05); }
  .btn-menu { padding: 14px 30px; font-size: 1rem; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.12); border-radius: 50px; color: rgba(255,255,255,0.7); cursor: pointer; transition: all 0.2s; font-family: 'DM Sans', sans-serif; }
  .btn-menu:hover { background: rgba(255,255,255,0.12); color: white; }
  .btn-terminar { margin-top: 14px; padding: 10px 24px; font-size: 0.8rem; background: rgba(255,209,102,0.1); border: 1px solid rgba(255,209,102,0.25); border-radius: 30px; color: var(--dorado); cursor: pointer; font-family: 'DM Sans', sans-serif; transition: all 0.2s; display: none; }
  .btn-terminar.visible { display: inline-block; }
  .cargando { position: fixed; inset: 0; background: var(--negro); display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 16px; z-index: 200; transition: opacity 0.4s; }
  .cargando.oculto { opacity: 0; pointer-events: none; }
  .spinner { width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--rosa); border-radius: 50%; animation: girar 0.8s linear infinite; }
  @keyframes girar { to { transform: rotate(360deg); } }
  @keyframes pulso { 0%,100%{transform:scale(1)} 50%{transform:scale(1.22)} }
  @keyframes temblor { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-7px)} 75%{transform:translateX(7px)} }
  @keyframes aparecer { from{opacity:0;transform:translateY(-18px) scale(0.95)} to{opacity:1;transform:translateY(0) scale(1)} }
  .confetti-piece { position:fixed;width:10px;height:10px;top:-20px;border-radius:2px;animation:confetti-fall linear forwards;pointer-events:none;z-index:999; }
  @keyframes confetti-fall { 0%{transform:translateY(-20px) rotate(0deg);opacity:1} 100%{transform:translateY(100vh) rotate(720deg);opacity:0} }
</style>
</head>
<body>

<div class="cargando" id="cargando">
  <div class="spinner"></div>
  <div style="color:rgba(255,255,255,0.4);font-size:0.85rem">Cargando castigos...</div>
</div>

<div class="overlay-dare" id="overlay-dare">
  <div class="dare-card">
    <div class="dare-nivel-badge" id="dare-badge">üíã NIVEL SEXI</div>
    <div class="dare-perdedor">¬°<span id="dare-perdedor-nombre">Jugador</span> perdi√≥ esta ronda!</div>
    <div class="dare-emoji-grande" id="dare-emoji">üíã</div>
    <div class="dare-titulo" id="dare-titulo">Tu atrevimiento</div>
    <div class="dare-descripcion" id="dare-descripcion">Descripci√≥n</div>
    <button class="btn-cumplido" onclick="cerrarDare()">‚úì ¬°Hecho! Siguiente ronda</button>
    <div class="dare-skip" onclick="cerrarDare()">Saltar (sin puntos extra)</div>
  </div>
</div>

<div class="pantalla activa" id="pantalla-inicio">
  <div class="logo">üî• Piedra, Papel<br>o Tijera</div>
  <p class="logo-sub">Edici√≥n para parejas</p>
  <p class="seccion-label">Nivel de calor</p>
  <div class="niveles">
    <div class="card-nivel nivel-1 activo" id="card-1" onclick="seleccionarNivel(1)">
      <span class="nivel-icono">üíã</span>
      <div class="nivel-texto"><h3>Sexi</h3><p>Coqueteo suave, besos y caricias</p></div>
      <span class="nivel-badge badge-1">SUAVE</span>
    </div>
    <div class="card-nivel nivel-2" id="card-2" onclick="seleccionarNivel(2)">
      <span class="nivel-icono">üî•</span>
      <div class="nivel-texto"><h3>Ardiente</h3><p>Mucho m√°s atrevido y expl√≠cito</p></div>
      <span class="nivel-badge badge-2">PICANTE</span>
    </div>
    <div class="card-nivel nivel-3" id="card-3" onclick="seleccionarNivel(3)">
      <span class="nivel-icono">üå∂Ô∏è</span>
      <div class="nivel-texto"><h3>Fuego total</h3><p>Sin filtros, solo para mayores atrevidos</p></div>
      <span class="nivel-badge badge-3">EXPLOSIVO</span>
    </div>
    <div class="card-nivel nivel-4" id="card-4" onclick="seleccionarNivel(4)">
      <span class="nivel-icono">üíÄ</span>
      <div class="nivel-texto"><h3>Hardcore ‚Äî Grupo</h3><p>Para 3+ personas. Sin l√≠mites.</p></div>
      <span class="nivel-badge badge-4">GRUPERO</span>
    </div>
  </div>
  <p class="seccion-label">Nombres</p>
  <div class="nombres-grid">
    <input class="input-nombre" id="input-j1" type="text" placeholder="Jugador 1" maxlength="16" />
    <input class="input-nombre" id="input-j2" type="text" placeholder="Jugador 2" maxlength="16" />
  </div>
  <p class="seccion-label">Rondas</p>
  <div class="rondas-grid" style="margin-bottom:35px">
    <button class="btn-ronda sel" onclick="seleccionarRondas(3,this)">Mejor<br>de 3</button>
    <button class="btn-ronda" onclick="seleccionarRondas(5,this)">Mejor<br>de 5</button>
    <button class="btn-ronda" onclick="seleccionarRondas(7,this)">Mejor<br>de 7</button>
    <button class="btn-ronda btn-libre" onclick="seleccionarRondas(0,this)">‚ôæÔ∏è<br>Libre</button>
  </div>
  <button class="btn-jugar" onclick="iniciarJuego()">üî• EMPEZAR</button>
</div>

<div class="pantalla" id="pantalla-juego">
  <div class="header-juego">
    <button class="btn-volver" onclick="volverInicio()">‚Üê Men√∫</button>
    <div class="info-ronda">Ronda <span id="ronda-actual">1</span> / <span id="ronda-total">3</span></div>
    <div style="width:70px"></div>
  </div>
  <div class="nivel-indicator" id="nivel-indicator">üíã NIVEL SEXI</div>
  <div class="progreso-container">
    <div class="progreso-nombres">
      <span class="pn1" id="nombre-j1-prog">Jugador 1</span>
      <span class="pn2" id="nombre-j2-prog">Jugador 2</span>
    </div>
    <div class="barras" id="barras-progreso"></div>
  </div>
  <div class="arena">
    <div class="jugador-box">
      <div class="nombre-jugador" id="nombre-j1-arena">J1</div>
      <div class="display-emoji" id="display-j1">‚ùì<div class="check-listo" id="check-j1">‚úì</div></div>
    </div>
    <div class="vs">VS</div>
    <div class="jugador-box">
      <div class="nombre-jugador" id="nombre-j2-arena">J2</div>
      <div class="display-emoji" id="display-j2">‚ùì<div class="check-listo" id="check-j2">‚úì</div></div>
    </div>
  </div>
  <div class="teclado-info" id="teclado-info" style="display:none">
    <div class="keys"><span class="key">A</span>üèîÔ∏è <span class="key">S</span>üìÑ <span class="key">D</span>‚úÇÔ∏è</div>
    <div style="color:rgba(255,255,255,0.2);font-size:0.7rem">en secreto</div>
    <div class="keys">üèîÔ∏è<span class="key">J</span> üìÑ<span class="key">K</span> ‚úÇÔ∏è<span class="key">L</span></div>
  </div>
  <div class="mensaje-local" id="mensaje-local"></div>
  <div class="botones" id="botones-pc">
    <button class="btn-opcion" onclick="jugarPC('piedra')">üèîÔ∏è</button>
    <button class="btn-opcion" onclick="jugarPC('papel')">üìÑ</button>
    <button class="btn-opcion" onclick="jugarPC('tijera')">‚úÇÔ∏è</button>
  </div>
  <div class="resultado" id="resultado">¬°Elige tu jugada!</div>
  <div class="marcador">
    <div class="stat victorias"><div class="numero" id="marcador-v">0</div><div class="label" id="marcador-v-label">J1</div></div>
    <div class="stat empates"><div class="numero" id="marcador-e">0</div><div class="label">Empates</div></div>
    <div class="stat derrotas"><div class="numero" id="marcador-d">0</div><div class="label" id="marcador-d-label">J2</div></div>
  </div>
  <button class="btn-terminar" id="btn-terminar" onclick="terminarLibre()">‚õ≥ Terminar partida</button>
</div>

<div class="pantalla" id="pantalla-ganador">
  <div class="trofeo" id="trofeo-emoji">üèÜ</div>
  <div class="ganador-titulo" id="ganador-titulo">¬°Ganaste!</div>
  <div class="ganador-sub" id="ganador-sub">Mejor de 3</div>
  <div class="stats-finales">
    <div class="stat-final"><div class="n" id="final-j1" style="color:#6ee7b7">0</div><div class="l" id="final-j1-label">J1</div></div>
    <div class="stat-final"><div class="n" id="final-emp" style="color:var(--dorado)">0</div><div class="l">Empates</div></div>
    <div class="stat-final"><div class="n" id="final-j2" style="color:var(--rojo)">0</div><div class="l" id="final-j2-label">J2</div></div>
  </div>
  <div class="btns-final">
    <button class="btn-revancha" onclick="revancha()">üîÅ Revancha</button>
    <button class="btn-menu" onclick="volverInicio()">üè† Men√∫</button>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CARGAR CASTIGOS DESDE castigos.json
// En vez de tener 200 l√≠neas de castigos ac√° adentro,
// el juego va a buscar el archivo y los carga.
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let daresBase = {};
let colasDares = {};

fetch('castigos.json')
  .then(r => r.json())
  .then(data => {
    daresBase = data;
    ocultarCargando();
  })
  .catch(() => {
    alert('No se pudo cargar castigos.json');
    ocultarCargando();
  });

function ocultarCargando() {
  const c = document.getElementById('cargando');
  c.classList.add('oculto');
  setTimeout(() => c.remove(), 500);
}

function getDare(nivelN) {
  const key = String(nivelN);
  if (!colasDares[key] || colasDares[key].length === 0) {
    const copia = [...daresBase[key]];
    for (let i = copia.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [copia[i], copia[j]] = [copia[j], copia[i]];
    }
    colasDares[key] = copia;
  }
  return colasDares[key].pop();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ESTADO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let nivel = 1, rondasTotal = 3, rondasNecesarias = 2, modoLibre = false;
let puntosJ1 = 0, puntosJ2 = 0, empatesTotal = 0, rondaActual = 1;
let juegoActivo = true, eleccionJ1 = null, eleccionJ2 = null, pendienteDare = null;
let nombreJ1 = 'Jugador 1', nombreJ2 = 'Jugador 2';

const emojis = { piedra:'üèîÔ∏è', papel:'üìÑ', tijera:'‚úÇÔ∏è' };
const ganaNormal = { piedra:'tijera', tijera:'papel', papel:'piedra' };
const nivelConfig = {
  1: { label:'üíã NIVEL SEXI', clase:'ni-1', badgeClase:'dnb-1', badgeLabel:'üíã SEXI' },
  2: { label:'üî• ARDIENTE', clase:'ni-2', badgeClase:'dnb-2', badgeLabel:'üî• ARDIENTE' },
  3: { label:'üå∂Ô∏è FUEGO TOTAL', clase:'ni-3', badgeClase:'dnb-3', badgeLabel:'üå∂Ô∏è FUEGO TOTAL' },
  4: { label:'üíÄ HARDCORE', clase:'ni-4', badgeClase:'dnb-4', badgeLabel:'üíÄ HARDCORE' },
};

function seleccionarNivel(n) {
  nivel = n;
  [1,2,3,4].forEach(i => { const el = document.getElementById('card-'+i); if(el) el.classList.toggle('activo', i===n); });
}

function seleccionarRondas(n, btn) {
  rondasTotal = n; modoLibre = n===0;
  rondasNecesarias = modoLibre ? Infinity : Math.ceil(n/2);
  document.querySelectorAll('.btn-ronda').forEach(b => b.classList.remove('sel'));
  btn.classList.add('sel');
}

function iniciarJuego() {
  puntosJ1=0; puntosJ2=0; empatesTotal=0; rondaActual=1;
  eleccionJ1=null; eleccionJ2=null; juegoActivo=true;
  nombreJ1 = document.getElementById('input-j1').value.trim() || 'Jugador 1';
  nombreJ2 = document.getElementById('input-j2').value.trim() || 'Jugador 2';
  document.getElementById('nombre-j1-prog').textContent  = nombreJ1;
  document.getElementById('nombre-j2-prog').textContent  = nombreJ2;
  document.getElementById('nombre-j1-arena').textContent = nombreJ1;
  document.getElementById('nombre-j2-arena').textContent = nombreJ2;
  document.getElementById('marcador-v-label').textContent = nombreJ1;
  document.getElementById('marcador-d-label').textContent = nombreJ2;
  document.getElementById('btn-terminar').classList.toggle('visible', modoLibre);
  const cfg = nivelConfig[nivel];
  const ni = document.getElementById('nivel-indicator');
  ni.textContent = cfg.label; ni.className = 'nivel-indicator ' + cfg.clase;
  document.getElementById('botones-pc').style.display = 'none';
  document.getElementById('teclado-info').style.display = 'flex';
  document.getElementById('mensaje-local').style.display = 'block';
  actualizarRonda(); construirBarras(); resetArena();
  document.getElementById('mensaje-local').textContent = '¬°Que cada uno elija en secreto!';
  mostrar('pantalla-juego');
}

function determinarResultado(j1, j2) {
  if (j1===j2) return 'empate';
  return ganaNormal[j1]===j2 ? 'j1' : 'j2';
}

function resolverRonda(j1, j2) {
  if (!juegoActivo) return;
  const res = determinarResultado(j1, j2);
  const dJ1 = document.getElementById('display-j1');
  const dJ2 = document.getElementById('display-j2');
  dJ1.className = 'display-emoji'; dJ2.className = 'display-emoji';
  dJ1.childNodes[0].textContent = emojis[j1];
  dJ2.childNodes[0].textContent = emojis[j2];
  let msg='', perdedor=null;
  if (res==='empate') {
    msg='ü§ù ¬°Empate! Nadie pierde esta vez...'; empatesTotal++;
    dJ1.classList.add('empate'); dJ2.classList.add('empate');
  } else if (res==='j1') {
    msg=`üéâ ¬°Gana ${nombreJ1}! ${nombreJ2} cumple el castigo`; puntosJ1++;
    dJ1.classList.add('ganaste'); dJ2.classList.add('perdiste'); perdedor=nombreJ2;
  } else {
    msg=`üéâ ¬°Gana ${nombreJ2}! ${nombreJ1} cumple el castigo`; puntosJ2++;
    dJ1.classList.add('perdiste'); dJ2.classList.add('ganaste'); perdedor=nombreJ1;
  }
  document.getElementById('resultado').textContent = msg;
  actualizarMarcadores(); actualizarBarras();
  eleccionJ1=null; eleccionJ2=null;
  const serieTermino = !modoLibre && (puntosJ1>=rondasNecesarias || puntosJ2>=rondasNecesarias);
  if (perdedor) {
    setTimeout(() => mostrarDare(perdedor, serieTermino), 500);
  } else {
    if (!serieTermino) {
      rondaActual++; actualizarRonda();
      setTimeout(() => { resetArena(); document.getElementById('mensaje-local').textContent='¬°Que cada uno elija en secreto!'; }, 800);
    } else { juegoActivo=false; setTimeout(mostrarGanador, 900); }
  }
}

function mostrarDare(perdedorNombre, serieTerminaDespues) {
  const dare = getDare(nivel);
  const cfg = nivelConfig[nivel];
  const badge = document.getElementById('dare-badge');
  badge.textContent = cfg.badgeLabel; badge.className = 'dare-nivel-badge ' + cfg.badgeClase;
  document.getElementById('dare-perdedor-nombre').textContent = perdedorNombre;
  document.getElementById('dare-emoji').textContent = dare.emoji;
  document.getElementById('dare-titulo').textContent = dare.titulo;
  document.getElementById('dare-descripcion').textContent = dare.desc;
  pendienteDare = { serieTermina: serieTerminaDespues };
  document.getElementById('overlay-dare').classList.add('visible');
}

function cerrarDare() {
  document.getElementById('overlay-dare').classList.remove('visible');
  const { serieTermina } = pendienteDare; pendienteDare=null;
  if (serieTermina) { juegoActivo=false; setTimeout(mostrarGanador, 300); }
  else {
    rondaActual++; actualizarRonda();
    setTimeout(() => { resetArena(); document.getElementById('mensaje-local').textContent='¬°Que cada uno elija en secreto!'; }, 200);
  }
}

document.addEventListener('keydown', (e) => {
  if (!juegoActivo) return;
  const mapa = {'a':'piedra','s':'papel','d':'tijera','j':'piedra','k':'papel','l':'tijera'};
  const tecla = e.key.toLowerCase();
  if (!mapa[tecla]) return;
  const esJ1 = ['a','s','d'].includes(tecla);
  const esJ2 = ['j','k','l'].includes(tecla);
  if (esJ1 && !eleccionJ1) { eleccionJ1=mapa[tecla]; document.getElementById('display-j1').classList.add('listo'); document.getElementById('check-j1').classList.add('visible'); }
  if (esJ2 && !eleccionJ2) { eleccionJ2=mapa[tecla]; document.getElementById('display-j2').classList.add('listo'); document.getElementById('check-j2').classList.add('visible'); }
  if (eleccionJ1 && eleccionJ2) { document.getElementById('mensaje-local').textContent='¬°Revelando!'; setTimeout(() => resolverRonda(eleccionJ1, eleccionJ2), 300); }
  else if (eleccionJ1) { document.getElementById('mensaje-local').textContent=`${nombreJ1} listo ‚è≥ esperando ${nombreJ2}...`; }
  else if (eleccionJ2) { document.getElementById('mensaje-local').textContent=`${nombreJ2} listo ‚è≥ esperando ${nombreJ1}...`; }
});

function resetArena() {
  const dJ1=document.getElementById('display-j1'), dJ2=document.getElementById('display-j2');
  dJ1.className='display-emoji esperando'; dJ2.className='display-emoji esperando';
  dJ1.childNodes[0].textContent='‚ùì'; dJ2.childNodes[0].textContent='‚ùì';
  document.getElementById('check-j1').classList.remove('visible');
  document.getElementById('check-j2').classList.remove('visible');
  document.getElementById('resultado').textContent='¬°Elige tu jugada!';
}
function actualizarRonda() { document.getElementById('ronda-actual').textContent=rondaActual; document.getElementById('ronda-total').textContent=modoLibre?'‚àû':rondasTotal; }
function actualizarMarcadores() { document.getElementById('marcador-v').textContent=puntosJ1; document.getElementById('marcador-e').textContent=empatesTotal; document.getElementById('marcador-d').textContent=puntosJ2; }
function construirBarras() {
  const cont=document.getElementById('barras-progreso'); cont.innerHTML='';
  const cant=modoLibre?10:rondasTotal;
  for(let i=0;i<cant;i++){const d=document.createElement('div');d.className='barra-punto';cont.appendChild(d);}
}
function actualizarBarras() {
  const barras=document.querySelectorAll('.barra-punto');
  barras.forEach(b=>b.className='barra-punto');
  let iJ1=0, iJ2=barras.length-1;
  for(let i=0;i<puntosJ1&&iJ1<=iJ2;i++,iJ1++) barras[iJ1].classList.add('j1');
  for(let i=0;i<puntosJ2&&iJ2>=iJ1;i++,iJ2--) barras[iJ2].classList.add('j2');
}
function mostrar(id) { document.querySelectorAll('.pantalla').forEach(p=>p.classList.remove('activa')); document.getElementById(id).classList.add('activa'); }
function volverInicio() { juegoActivo=false; mostrar('pantalla-inicio'); }
function terminarLibre() { juegoActivo=false; mostrarGanador(); }
function mostrarGanador() {
  const j1gano=puntosJ1>puntosJ2, empate=puntosJ1===puntosJ2;
  document.getElementById('trofeo-emoji').textContent=empate?'ü§ù':'üèÜ';
  document.getElementById('ganador-titulo').textContent=empate?'¬°Empate t√©cnico!':j1gano?`üéâ ¬°Gana ${nombreJ1}!`:`üéâ ¬°Gana ${nombreJ2}!`;
  document.getElementById('ganador-sub').textContent=modoLibre?`Modo libre ¬∑ ${rondaActual-1} rondas jugadas`:`Mejor de ${rondasTotal}`;
  document.getElementById('final-j1').textContent=puntosJ1;
  document.getElementById('final-j2').textContent=puntosJ2;
  document.getElementById('final-emp').textContent=empatesTotal;
  document.getElementById('final-j1-label').textContent=nombreJ1;
  document.getElementById('final-j2-label').textContent=nombreJ2;
  if(!empate) lanzarConfetti();
  mostrar('pantalla-ganador');
}
function revancha() { iniciarJuego(); }
function lanzarConfetti() {
  const colores=['#ff2d55','#ff6b95','#ffd166','#7c2d8c','#ff4d00','#6ee7b7'];
  for(let i=0;i<70;i++){setTimeout(()=>{const c=document.createElement('div');c.className='confetti-piece';c.style.left=Math.random()*100+'vw';c.style.background=colores[Math.floor(Math.random()*colores.length)];c.style.animationDuration=(1.5+Math.random()*2)+'s';c.style.width=(6+Math.random()*8)+'px';c.style.height=(6+Math.random()*8)+'px';c.style.borderRadius=Math.random()>0.5?'50%':'2px';document.body.appendChild(c);setTimeout(()=>c.remove(),4000);},i*35);}
}
</script>
</body>
</html>